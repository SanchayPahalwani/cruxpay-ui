"use strict";$(document).ready(function(){var a,i=window.isDev?"https://registrar.coinswitch.co:3000":"https://registrar-prod.coinswitch.co:3000",d=new function(){var l=this;this.availableStates=["registration","customisation"],this.registration={el:$("#registration"),hide:function(){this.el.addClass("cs-hide")},show:function(){this.el.removeClass("cs-hide")}},this.customisation={el:$("#customisation"),hide:function(){this.el.addClass("cs-hide")},show:function(){this.el.removeClass("cs-hide")}},this.renderState=function(t){if(l.availableStates.includes(t)){var e=!0,i=!1,a=void 0;try{for(var r,n=l.availableStates[Symbol.iterator]();!(e=(r=n.next()).done);e=!0){var s=r.value;s===t?l[s].show():l[s].hide()}}catch(t){i=!0,a=t}finally{try{e||null==n.return||n.return()}finally{if(i)throw a}}}},this.renderApp=function(t){t&&t.cruxIDSubdomain?(l.renderState("customisation"),v.init({cruxIDSubdomain:t.cruxIDSubdomain,walletClientName:t.walletClientName,availableCurrencies:t.availableCurrencies,publicAddressCurrencies:t.publicAddressCurrencies,allCurrencies:t.assetList&&t.clientMapping&&0<t.assetList.length&&0<Object.keys(t.clientMapping).length?function(t){var e=t.assetList,i=t.clientMapping,a=t.imageMapping,r={};for(var n in i)r[i[n]]=n;var s=[];for(var l in e){var o=e[l];if(o.assetId in r){var c={name:o.name,symbol:r[o.assetId],img:a[o.assetId]&&a[o.assetId].image};s.push(c)}}return s}(t):[]})):(l.renderState("registration"),$(".id-status").html("@".concat(t.walletClientName,".crux"))),t&&t.theme&&(document.documentElement.style.setProperty("--mdc-theme-secondary",t.theme),document.documentElement.style.setProperty("--mdc-theme-primary",t.theme))}},u={show:function(t,e){t.attr("disabled","true"),t.off("click",e)},hide:function(t,e){t.removeAttr("disabled","false"),t.on("click",e)}},t=document.querySelectorAll(".mdc-text-field"),e=!0,r=!1,n=void 0;try{for(var s,l=t[Symbol.iterator]();!(e=(s=l.next()).done);e=!0){var o=s.value;mdc.textField.MDCTextField.attachTo(o)}}catch(t){r=!0,n=t}finally{try{e||null==l.return||l.return()}finally{if(r)throw n}}var c={input:$("#cruxpayId"),inputParent:$(".cruxpay-id__container"),helperText:$("#cruxpay-id__helper-text"),parentContainer:$(".cruxpay-id__container").parent(),isValid:!1,displayError:function(t){this.helperText.removeClass("helper-text--success"),this.inputParent.addClass("mdc-text-field--invalid"),this.parentContainer.addClass("has-error"),this.helperText.html(t)},displaySuccess:function(t){c.inputParent.removeClass("mdc-text-field--invalid"),c.helperText.addClass("helper-text--success"),c.parentContainer.removeClass("has-error"),c.helperText.html(t)},displayHelpText:function(t){c.helperText.removeClass("helper-text--success"),c.inputParent.removeClass("mdc-text-field--invalid"),c.parentContainer.removeClass("has-error"),c.helperText.html(t)},getId:function(){return this.input.val()},validation:{hasDigit:function(t){return/[0-9]/.test(t)},hasAlphabets:function(t){return/[A-Za-z]/.test(t)},hasSpecialCharacters:function(t){return/[~!@#$%^&*()=+,.?":{}|<>:;\[\]]/.test(t)},hasMinLength:function(t){return 4<=t.toString().length},hasMaxLength:function(t){return t.toString().length<=20},hasValidStartCharater:function(t){return!t.startsWith("_")&&!t.startsWith("-")},isValid:function(t){var e=!1;return this.hasDigit(t)&&this.hasAlphabets(t)&&(e=!0),e}},runValidations:function(t){this.validation.hasDigit(t)?this.isValid=!0:(this.isValid=!1,this.displayError("Your ID should contain numbers")),this.validation.hasAlphabets(t)?this.isValid=!0:(this.isValid=!1,this.displayError("Your ID should contain alphabets"))}},h=null;c.input.on("keyup",function(e){c.displayHelpText("Checking availability"),c.isValid=!1,clearTimeout(h),h=setTimeout(function(){var t=e.target.value;t&&0<t.length&&(c.validation.hasDigit(t)?c.validation.hasAlphabets(t)?function(a){$.ajax({type:"GET",url:"".concat(i,"/status/").concat(a),success:function(t){c.isValid=!1,c.displayError("".concat(a," is unavailable"))},error:function(t,e,i){404==t.status&&(c.isValid=!0,c.displaySuccess("".concat(a," is available")))}})}(t):c.displayError("Your ID should contain alphabets"):c.displayError("Your ID should contain numbers"))},500)});var p={input:$("#cruxpayPassword"),helperText:$("#cruxpay-password__helper-text"),inputParent:$(".cruxpay-password__container"),parentContainer:$(".cruxpay-password__container").parent(),isValid:!1,validation:{isValid:function(t){return/^[a-zA-Z0-9$@!#^&%_-]{8,50}$/.test(String(t).toLowerCase())},containsId:function(t){return t===c.input.val()},hasDigit:function(t){return/[0-9]/.test(t)},hasLowerCase:function(t){return/[a-z]/.test(t)},hasUpperCase:function(t){return/[A-Z]/.test(t)},hasSpecialCharacter:function(t){return/(?=.*[!#$%&?@"])/.test(t)}},displayError:function(t){this.helperText.removeClass("helper-text--success"),this.inputParent.addClass("mdc-text-field--invalid"),this.parentContainer.addClass("has-error"),this.helperText.html(t)},clearAllError:function(){this.helperText.addClass("helper-text--success"),this.inputParent.removeClass("mdc-text-field--invalid"),this.parentContainer.removeClass("has-error"),this.helperText.html("")},toggleValidationBlock:function(t){t?$(".validation-rules").css("opacity",1):$(".validation-rules").css("opacity",0)},setValidation:function(t,e){var i=$("#validation-".concat(t));this.isValid=e,i&&0<i.length&&(e?(i.removeClass("rule-isInvalid"),i.addClass("rule-isValid")):(i.addClass("rule-isInvalid"),i.removeClass("rule-isValid")))},getPassword:function(){return this.input.val()},runValidations:function(t){this.validation.isValid(t)?this.setValidation("charLen",!0):(this.setValidation("charLen",!1),this.displayError("Minimum length required is 8. Only following special characters !,#,$,%,&,?,@ are allowed")),this.validation.containsId(t)?(this.setValidation("sameAsId",!1),this.displayError("Password must be different from CruxPay ID")):this.setValidation("sameAsId",!0),this.validation.hasDigit(t)?this.setValidation("digit",!0):(this.setValidation("digit",!1),this.displayError("Password must be have atleast one number")),this.validation.hasLowerCase(t)?this.setValidation("lowercase",!0):(this.setValidation("lowercase",!1),this.displayError("Password must be have atleast one lowercase letter")),this.validation.hasUpperCase(t)?this.setValidation("uppercase",!0):(this.setValidation("uppercase",!1),this.displayError("Password must be have atleast one uppercase letter")),this.validation.hasSpecialCharacter(t)?(this.setValidation("specialCharater",!0),this.clearAllError()):(this.setValidation("specialCharater",!1),this.displayError("Password must be have atleast one of following special characters !,#,$,%,&,?,@ are allowed"))}};p.input.on("keyup",function(t){p.toggleValidationBlock(!0),p.runValidations(p.getPassword())}),$("#createId").on("click",function t(){if(c.isValid){u.show($("#createId"),t);var e=c.getId(),i=p.getPassword();d.data={newPayIDName:e,newPayIDPass:i},a.cruxIDSubdomain=e,d.renderApp(a)}else p.isValid||p.runValidations(p.getPassword()),c.isValid||(c.getId()&&0<c.getId().length?c.validation.isValid(c.getId())?c.displayError("".concat(c.getId()," is unavailable")):c.runValidations(c.getId()):c.displayError("cruxpay id is needed"))});var v={container:$("#currencyContainer"),selectedCurCintainer:$("#selectedCurContainer"),search:$("#cruxSearchCur"),selectedRadio:"custom",radioContainer:$(".customisation__radio-select"),init:function(t){var i=this,e=t.cruxIDSubdomain,a=t.walletClientName,r=t.availableCurrencies,n=t.publicAddressCurrencies,s=t.allCurrencies;$("#cruxpayIdName").html("".concat(e,"@").concat(a,".crux"));var l=[],o=!0,c=!1,d=void 0;try{for(var u,h=s[Symbol.iterator]();!(o=(u=h.next()).done);o=!0){var p=u.value;r[p.symbol]&&(p.address=r[p.symbol],n.includes(p.symbol)?p.selected=!0:p.selected=!1,l.push(p))}}catch(t){c=!0,d=t}finally{try{o||null==h.return||h.return()}finally{if(c)throw d}}this.list=l,this.renderRadios(),this.search.on("keyup",function(t){var e=i.filter(i.list,t.target.value);i.renderCurList(e)}),this.renderCurList(this.list),this.renderSelectedCurPills(this.list)},availableRadios:[{id:"radio-selectCustom",value:"custom",name:"Custom"},{id:"radio-selectAll",value:"all",name:"All"},{id:"radio-selectPopular",value:"popular",name:"Popular"},{id:"radio-selectNone",value:"none",name:"None"}],renderCurList:function(t){var e="",i=!0,a=!1,r=void 0;try{for(var n,s=t[Symbol.iterator]();!(i=(n=s.next()).done);i=!0){var l=n.value;e+=this.renderCur(l)}}catch(t){a=!0,r=t}finally{try{i||null==s.return||s.return()}finally{if(a)throw r}}$(this.container).html(e),this.bindCheckboxEvents()},renderCur:function(t){var e=t.name,i=t.symbol,a=t.img,r=t.selected;t.address;return'\n\t\t\t<div class="customisation__currency '.concat(r?"customisation__currency--isSelected":"",' ">\n\t\t\t\t<div class="mdc-form-field">\n\t\t\t\t\t<div class="mdc-checkbox">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tdata-symbol="').concat(i,'"\n\t\t\t\t\t\t\ttype="checkbox"\n\t\t\t\t\t\t\tclass="mdc-checkbox__native-control"\n\t\t\t\t\t\t\tid="checkbox-').concat(i,'"\n\t\t\t\t\t\t\t').concat(r?"checked":"",'\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div class="mdc-checkbox__background">\n\t\t\t\t\t\t\t<svg class="mdc-checkbox__checkmark" viewBox="0 0 24 24">\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\tclass="mdc-checkbox__checkmark-path"\n\t\t\t\t\t\t\t\tfill="none"\n\t\t\t\t\t\t\t\td="M1.73,12.91 8.1,19.28 22.79,4.59"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t<div class="mdc-checkbox__mixedmark"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<label for="checkbox-').concat(i,'" class="customisation__checkbox-label">\n\t\t\t\t\t\t<div class="customisation__checkbox-label--inner">\n\t\t\t\t\t\t\t<img class="customisation__currency-logo" src="data:image/jpeg;base64,').concat(a,'" />\n\t\t\t\t\t\t\t<div class="customisation__currency-name">').concat(e,'</div>\n\t\t\t\t\t\t\t<div class="customisation__currency-symbol">').concat(i.toUpperCase(),"</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t")},renderSelectedCurPills:function(t){var e="",i=!0,a=!1,r=void 0;try{for(var n,s=t[Symbol.iterator]();!(i=(n=s.next()).done);i=!0){var l=n.value;l.selected&&(e+=this.renderSelectedPill(l))}}catch(t){a=!0,r=t}finally{try{i||null==s.return||s.return()}finally{if(a)throw r}}$(this.selectedCurCintainer).html(e),this.bindPillEvents()},renderSelectedPill:function(t){var e=t.symbol;return'\n\t\t\t\t<div class="selected-currency__pill">\n\t\t\t\t\t<strong>'.concat(e.toUpperCase(),'</strong>\n\t\t\t\t\t<i class="material-icons" data-symbol="').concat(e,'">clear</i>\n\t\t\t\t</div>\n\t\t\t')},renderRadios:function(){var t="",e=!0,i=!1,a=void 0;try{for(var r,n=this.availableRadios[Symbol.iterator]();!(e=(r=n.next()).done);e=!0){var s=r.value;t+=this.renderRadioEl(s)}}catch(t){i=!0,a=t}finally{try{e||null==n.return||n.return()}finally{if(i)throw a}}$(this.radioContainer).html(t),this.bindRadioEvents()},renderRadioEl:function(t){var e=t.id,i=t.value,a=t.name;return'\n\t\t\t\t<div class="mdc-form-field">\n\t\t\t\t\t<div class="mdc-radio mdc-custom-radio">\n\t\t\t\t\t\t<input class="mdc-radio__native-control" type="radio" id="'.concat(e,'" name="radios" value="').concat(i,'">\n\t\t\t\t\t\t<div class="mdc-radio__background">\n\t\t\t\t\t\t\t<div class="mdc-radio__outer-circle"></div>\n\t\t\t\t\t\t\t<div class="mdc-radio__inner-circle"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<label for="').concat(e,'">').concat(a,"</label>\n\t\t\t\t</div>\n\t\t\t")},filter:function(t,e){var i=e||"";try{var a=new RegExp(i,"ig");return t.filter(function(t){return t.name.match(a)||t.symbol.match(a)})}catch(t){return[]}},bindCheckboxEvents:function(){var a=this;$(".mdc-checkbox__native-control").on("click",function(t){var e=$(t.target);for(var i in a.list){a.list[i].symbol===e.data("symbol")&&(a.list[i].selected=e.is(":checked"))}$("#radio-selectCustom").prop("checked","true"),a.renderSelectedCurPills(a.list)})},bindPillEvents:function(){var a=this;$(".selected-currency__pill").on("click",function(t){var e=$(t.target);for(var i in a.list){a.list[i].symbol===e.data("symbol")&&(a.list[i].selected=!1)}$("#radio-selectCustom").prop("checked","true"),a.renderCurList(a.list),a.renderSelectedCurPills(a.list)})},bindRadioEvents:function(){var s=this;$(".mdc-radio__native-control").on("click",function(t){switch(t.target.value){case"custom":s.selectedRadio="custom";break;case"popular":var e=["btc","eth","xrp","bch","ltc"];for(var i in s.list){var a=s.list[i];e.includes(a.symbol)?s.list[i].selected=!0:s.list[i].selected=!1}s.renderCurList(s.list),s.renderSelectedCurPills(s.list),s.selectedRadio="popular";break;case"all":for(var r in s.list)s.list[r].selected=!0;s.renderCurList(s.list),s.renderSelectedCurPills(s.list),s.selectedRadio="all";break;case"none":for(var n in s.list)s.list[n].selected=!1;s.renderCurList(s.list),s.renderSelectedCurPills(s.list),s.selectedRadio="none"}});var t=$(".mdc-radio__native-control"),e=!0,i=!1,a=void 0;try{for(var r,n=t[Symbol.iterator]();!(e=(r=n.next()).done);e=!0){var l=r.value;this.selectedRadio===l.value&&l.setAttribute("checked","true")}}catch(t){i=!0,a=t}finally{try{e||null==n.return||n.return()}finally{if(i)throw a}}}};$("#updateCustomization").on("click",function t(){u.show($("#updateCustomization"),t);var e=[],i=!0,a=!1,r=void 0;try{for(var n,s=v.list[Symbol.iterator]();!(i=(n=s.next()).done);i=!0){var l=n.value;l.selected&&e.push(l.symbol.toUpperCase())}}catch(t){a=!0,r=t}finally{try{i||null==s.return||s.return()}finally{if(a)throw r}}if(d.isExistingAccount){var o={type:"editExisting",data:{checkedCurrencies:e}};o=JSON.stringify(o),o=OpenPay.Encryption.eciesEncryptString(o,window.encryptionKey),window.parent.postMessage(o,"*")}else{var c={type:"createNew",data:{newPayIDName:d.data.newPayIDName,newPayIDPass:d.data.newPayIDPass,checkedCurrencies:e}};c=OpenPay.Encryption.eciesEncryptString(JSON.stringify(c),window.encryptionKey),window.parent.postMessage(c,"*")}}),$("#closeSetup").on("click",function(){var t={type:"closeIframe"};t=OpenPay.Encryption.eciesEncryptString(JSON.stringify(t),window.encryptionKey),window.parent.postMessage(t,"*")}),function t(){window.walletInfo&&window.imageMapping?((a=window.walletInfo).imageMapping=window.imageMapping,d.isExistingAccount=!!a.cruxIDSubdomain,d.renderApp(a)):setTimeout(function(){t()},500)}()});