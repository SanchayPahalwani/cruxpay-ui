"use strict";$(document).ready(function(){var a,t=new function(){var l=this;this.availableStates=["registration","customisation"],this.registration={el:$("#registration"),hide:function(){this.el.addClass("cs-hide")},show:function(){this.el.removeClass("cs-hide")}},this.customisation={el:$("#customisation"),hide:function(){this.el.addClass("cs-hide")},show:function(){this.el.removeClass("cs-hide")}},this.renderState=function(e){if(l.availableStates.includes(e)){var t=!0,i=!1,a=void 0;try{for(var s,n=l.availableStates[Symbol.iterator]();!(t=(s=n.next()).done);t=!0){var r=s.value;r===e?l[r].show():l[r].hide()}}catch(e){i=!0,a=e}finally{try{t||null==n.return||n.return()}finally{if(i)throw a}}}}};t.renderState("customisation"),window.addEventListener("message",function(e){a=JSON.parse(e.data),console.log("currentInput",a),a&&a.payIDName?t.renderState("registration"):t.renderState("customisation")},!1);var e=document.querySelectorAll(".mdc-text-field"),i=!0,s=!1,n=void 0;try{for(var r,l=e[Symbol.iterator]();!(i=(r=l.next()).done);i=!0){var o=r.value;mdc.textField.MDCTextField.attachTo(o)}}catch(e){s=!0,n=e}finally{try{i||null==l.return||l.return()}finally{if(s)throw n}}var c={input:$("#cruxpayId"),inputParent:$(".cruxpay-id__container"),helperText:$("#cruxpay-id__helper-text"),parentContainer:$(".cruxpay-id__container").parent(),displayError:function(e){this.helperText.removeClass("helper-text--success"),this.inputParent.addClass("mdc-text-field--invalid"),this.parentContainer.addClass("has-error"),this.helperText.html(e)},displaySuccess:function(e){c.inputParent.removeClass("mdc-text-field--invalid"),c.helperText.addClass("helper-text--success"),c.parentContainer.removeClass("has-error"),c.helperText.html(e)},displayHelpText:function(e){c.helperText.removeClass("helper-text--success"),c.inputParent.removeClass("mdc-text-field--invalid"),c.parentContainer.removeClass("has-error"),c.helperText.html(e)},getId:function(){return this.input.val()},isValid:!1},d=null;c.input.on("keyup",function(e){c.displayHelpText("Checking availability"),c.isValid=!1,clearTimeout(d),d=setTimeout(function(){e.target.value&&0<e.target.value.length&&function(a){$.ajax({type:"GET",url:"https://167.71.234.131:3000/status/".concat(a),success:function(e){c.isValid=!1,c.displayError("".concat(a," is unavailable"))},error:function(e,t,i){404==e.status&&(c.isValid=!0,c.displaySuccess("".concat(a," is available")))}})}(e.target.value)},500)});var u={input:$("#cruxpayPassword"),helperText:$("#cruxpay-password__helper-text"),inputParent:$(".cruxpay-password__container"),parentContainer:$(".cruxpay-password__container").parent(),isValid:!1,validation:{isValid:function(e){return/^[a-zA-Z0-9$@!#^&%_-]{8,50}$/.test(String(e).toLowerCase())},containsId:function(e){return e===c.input.val()},hasDigit:function(e){return/[0-9]/.test(e)},hasLowerCase:function(e){return/[a-z]/.test(e)},hasUpperCase:function(e){return/[A-Z]/.test(e)},hasSpecialCharacter:function(e){return/(?=.*[!#$%&?@"])/.test(e)}},displayError:function(e){this.helperText.removeClass("helper-text--success"),this.inputParent.addClass("mdc-text-field--invalid"),this.parentContainer.addClass("has-error"),this.helperText.html(e)},clearAllError:function(){this.helperText.addClass("helper-text--success"),this.inputParent.removeClass("mdc-text-field--invalid"),this.parentContainer.removeClass("has-error"),this.helperText.html("")},toggleValidationBlock:function(e){e?$(".validation-rules").css("opacity",1):$(".validation-rules").css("opacity",0)},setValidation:function(e,t){var i=$("#validation-".concat(e));this.isValid=t,i&&0<i.length&&(t?(i.removeClass("rule-isInvalid"),i.addClass("rule-isValid")):(i.addClass("rule-isInvalid"),i.removeClass("rule-isValid")))},getPassword:function(){return this.input.val()},runValidations:function(e){this.validation.isValid(e)?this.setValidation("charLen",!0):(this.setValidation("charLen",!1),this.displayError("Minimum length required is 8. Only following special characters !,#,$,%,&,?,@ are allowed")),this.validation.containsId(e)?(this.setValidation("sameAsId",!1),this.displayError("Password must be different from CruxPay ID")):this.setValidation("sameAsId",!0),this.validation.hasDigit(e)?this.setValidation("digit",!0):(this.setValidation("digit",!1),this.displayError("Password must be have atleast one number")),this.validation.hasLowerCase(e)?this.setValidation("lowercase",!0):(this.setValidation("lowercase",!1),this.displayError("Password must be have atleast one lowercase letter")),this.validation.hasUpperCase(e)?this.setValidation("uppercase",!0):(this.setValidation("uppercase",!1),this.displayError("Password must be have atleast one uppercase letter")),this.validation.hasSpecialCharacter(e)?(this.setValidation("specialCharater",!0),this.clearAllError()):(this.setValidation("specialCharater",!1),this.displayError("Password must be have atleast one of following special characters !,#,$,%,&,?,@ are allowed"))}};u.input.on("keyup",function(e){u.toggleValidationBlock(!0),u.runValidations(u.getPassword())}),$("#createId").on("click",function(){if(c.isValid&&u.isValid){var e=c.getId(),t=u.getPassword(),i={type:"createNew",data:{newPayIDName:e,newPayIDPass:t}};"iframe"==a.experience?window.parent.postMessage(JSON.stringify(i),"*"):window.opener.postMessage(JSON.stringify(i),"*")}else u.isValid||u.runValidations(u.getPassword()),c.isValid||c.displayError(c.getId()&&0<c.getId().length?"".concat(c.getId()," is unavailable"):"cruxpay id is needed")});var h={container:$("#currencyContainer"),selectedCurCintainer:$("#selectedCurContainer"),list:[{name:"Bitcoin",symbol:"btc",img:"https://files.coinswitch.co/public/coins/btc.png",selected:!0},{name:"Ethereum",symbol:"eth",img:"https://files.coinswitch.co/public/coins/eth.png",selected:!0},{name:"Litecoin",symbol:"ltc",img:"https://files.coinswitch.co/public/coins/ltc.png",selected:!1}],renderCurList:function(e){var t="",i=!0,a=!1,s=void 0;try{for(var n,r=e[Symbol.iterator]();!(i=(n=r.next()).done);i=!0){var l=n.value;t+=this.renderCur(l)}}catch(e){a=!0,s=e}finally{try{i||null==r.return||r.return()}finally{if(a)throw s}}$(this.container).html(t)},renderCur:function(e){var t=e.name,i=e.symbol,a=e.img,s=e.selected;return'\n            <div class="customisation__currency '.concat(s?"customisation__currency--isSelected":"",' ">\n                <div class="mdc-form-field">\n                    <div class="mdc-checkbox">\n                        <input\n                            type="checkbox"\n                            class="mdc-checkbox__native-control"\n                            id="checkbox-').concat(i,'"\n                            ').concat(s?"checked":"",'\n                        />\n                        <div class="mdc-checkbox__background">\n                            <svg class="mdc-checkbox__checkmark" viewBox="0 0 24 24">\n                            <path\n                                class="mdc-checkbox__checkmark-path"\n                                fill="none"\n                                d="M1.73,12.91 8.1,19.28 22.79,4.59"\n                            />\n                            </svg>\n                            <div class="mdc-checkbox__mixedmark"></div>\n                        </div>\n                    </div>\n                    <label for="checkbox-').concat(i,'" class="customisation__checkbox-label">\n                        <img class="customisation__currency-logo" src="').concat(a,'" />\n                        <div class="customisation__currency-name">').concat(t,'</div>\n                    </label>\n                </div>\n                <div class="customisation__currency-symbol">').concat(i.toUpperCase(),"</div>\n            </div>\n            ")},renderSelectedCurPills:function(e){var t="",i=!0,a=!1,s=void 0;try{for(var n,r=e[Symbol.iterator]();!(i=(n=r.next()).done);i=!0){var l=n.value;t+=this.renderSelectedPill(l)}}catch(e){a=!0,s=e}finally{try{i||null==r.return||r.return()}finally{if(a)throw s}}$(this.selectedCurCintainer).html(t)},renderSelectedPill:function(e){var t=e.symbol;return'\n                <div class="selected-currency__pill">\n                    <strong>'.concat(t.toUpperCase(),'</strong>\n                    <i class="material-icons">clear</i>\n                </div>\n            ')}};h.renderCurList(h.list),h.renderSelectedCurPills(h.list)});