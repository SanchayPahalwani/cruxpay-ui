"use strict";$(document).ready(function(){var a,e=new function(){var l=this;this.availableStates=["registration","customisation"],this.registration={el:$("#registration"),hide:function(){this.el.addClass("cs-hide")},show:function(){this.el.removeClass("cs-hide")}},this.customisation={el:$("#customisation"),hide:function(){this.el.addClass("cs-hide")},show:function(){this.el.removeClass("cs-hide")}},this.renderState=function(t){if(l.availableStates.includes(t)){var e=!0,i=!1,a=void 0;try{for(var s,r=l.availableStates[Symbol.iterator]();!(e=(s=r.next()).done);e=!0){var n=s.value;n===t?l[n].show():l[n].hide()}}catch(t){i=!0,a=t}finally{try{e||null==r.return||r.return()}finally{if(i)throw a}}}}};e.renderState("customisation"),window.addEventListener("message",function(t){a=JSON.parse(t.data),console.log("currentInput",a),a&&a.payIDName?e.renderState("registration"):e.renderState("customisation")},!1);var t=document.querySelectorAll(".mdc-text-field"),i=!0,s=!1,r=void 0;try{for(var n,l=t[Symbol.iterator]();!(i=(n=l.next()).done);i=!0){var o=n.value;mdc.textField.MDCTextField.attachTo(o)}}catch(t){s=!0,r=t}finally{try{i||null==l.return||l.return()}finally{if(s)throw r}}var c={input:$("#cruxpayId"),inputParent:$(".cruxpay-id__container"),helperText:$("#cruxpay-id__helper-text"),parentContainer:$(".cruxpay-id__container").parent(),displayError:function(t){this.helperText.removeClass("helper-text--success"),this.inputParent.addClass("mdc-text-field--invalid"),this.parentContainer.addClass("has-error"),this.helperText.html(t)},displaySuccess:function(t){c.inputParent.removeClass("mdc-text-field--invalid"),c.helperText.addClass("helper-text--success"),c.parentContainer.removeClass("has-error"),c.helperText.html(t)},displayHelpText:function(t){c.helperText.removeClass("helper-text--success"),c.inputParent.removeClass("mdc-text-field--invalid"),c.parentContainer.removeClass("has-error"),c.helperText.html(t)},getId:function(){return this.input.val()},isValid:!1},d=null;c.input.on("keyup",function(t){c.displayHelpText("Checking availability"),c.isValid=!1,clearTimeout(d),d=setTimeout(function(){t.target.value&&0<t.target.value.length&&function(a){$.ajax({type:"GET",url:"https://167.71.234.131:3000/status/".concat(a),success:function(t){c.isValid=!1,c.displayError("".concat(a," is unavailable"))},error:function(t,e,i){404==t.status&&(c.isValid=!0,c.displaySuccess("".concat(a," is available")))}})}(t.target.value)},500)});var u={input:$("#cruxpayPassword"),helperText:$("#cruxpay-password__helper-text"),inputParent:$(".cruxpay-password__container"),parentContainer:$(".cruxpay-password__container").parent(),isValid:!1,validation:{isValid:function(t){return/^[a-zA-Z0-9$@!#^&%_-]{8,50}$/.test(String(t).toLowerCase())},containsId:function(t){return t===c.input.val()},hasDigit:function(t){return/[0-9]/.test(t)},hasLowerCase:function(t){return/[a-z]/.test(t)},hasUpperCase:function(t){return/[A-Z]/.test(t)},hasSpecialCharacter:function(t){return/(?=.*[!#$%&?@"])/.test(t)}},displayError:function(t){this.helperText.removeClass("helper-text--success"),this.inputParent.addClass("mdc-text-field--invalid"),this.parentContainer.addClass("has-error"),this.helperText.html(t)},clearAllError:function(){this.helperText.addClass("helper-text--success"),this.inputParent.removeClass("mdc-text-field--invalid"),this.parentContainer.removeClass("has-error"),this.helperText.html("")},toggleValidationBlock:function(t){t?$(".validation-rules").css("opacity",1):$(".validation-rules").css("opacity",0)},setValidation:function(t,e){var i=$("#validation-".concat(t));this.isValid=e,i&&0<i.length&&(e?(i.removeClass("rule-isInvalid"),i.addClass("rule-isValid")):(i.addClass("rule-isInvalid"),i.removeClass("rule-isValid")))},getPassword:function(){return this.input.val()},runValidations:function(t){this.validation.isValid(t)?this.setValidation("charLen",!0):(this.setValidation("charLen",!1),this.displayError("Minimum length required is 8. Only following special characters !,#,$,%,&,?,@ are allowed")),this.validation.containsId(t)?(this.setValidation("sameAsId",!1),this.displayError("Password must be different from CruxPay ID")):this.setValidation("sameAsId",!0),this.validation.hasDigit(t)?this.setValidation("digit",!0):(this.setValidation("digit",!1),this.displayError("Password must be have atleast one number")),this.validation.hasLowerCase(t)?this.setValidation("lowercase",!0):(this.setValidation("lowercase",!1),this.displayError("Password must be have atleast one lowercase letter")),this.validation.hasUpperCase(t)?this.setValidation("uppercase",!0):(this.setValidation("uppercase",!1),this.displayError("Password must be have atleast one uppercase letter")),this.validation.hasSpecialCharacter(t)?(this.setValidation("specialCharater",!0),this.clearAllError()):(this.setValidation("specialCharater",!1),this.displayError("Password must be have atleast one of following special characters !,#,$,%,&,?,@ are allowed"))}};u.input.on("keyup",function(t){u.toggleValidationBlock(!0),u.runValidations(u.getPassword())}),$("#createId").on("click",function(){if(c.isValid&&u.isValid){var t=c.getId(),e=u.getPassword(),i={type:"createNew",data:{newPayIDName:t,newPayIDPass:e}};"iframe"==a.experience?window.parent.postMessage(JSON.stringify(i),"*"):window.opener.postMessage(JSON.stringify(i),"*")}else u.isValid||u.runValidations(u.getPassword()),c.isValid||c.displayError(c.getId()&&0<c.getId().length?"".concat(c.getId()," is unavailable"):"cruxpay id is needed")});var h={container:$("#currencyContainer"),list:[{name:"Bitcoin",symbol:"btc",img:"https://files.coinswitch.co/public/coins/btc.png",selected:!0},{name:"Ethereum",symbol:"eth",img:"https://files.coinswitch.co/public/coins/eth.png",selected:!0},{name:"Litecoin",symbol:"ltc",img:"https://files.coinswitch.co/public/coins/ltc.png",selected:!1}],renderCurList:function(t){var e="",i=!0,a=!1,s=void 0;try{for(var r,n=t[Symbol.iterator]();!(i=(r=n.next()).done);i=!0){var l=r.value;e+=this.renderCur(l)}}catch(t){a=!0,s=t}finally{try{i||null==n.return||n.return()}finally{if(a)throw s}}$(this.container).html(e)},renderCur:function(t){var e=t.name,i=t.symbol,a=t.img,s=t.selected;return'\n            <div class="customisation__currency '.concat(s?"customisation__currency--isSelected":"",' ">\n                <img class="customisation__currency-logo" src="').concat(a,'" />\n                <div class="customisation__currency-name">').concat(e,'</div>\n                <div class="customisation__currency-symbol">').concat(i.toUpperCase(),"</div>\n            </div>\n            ")}};h.renderCurList(h.list)});