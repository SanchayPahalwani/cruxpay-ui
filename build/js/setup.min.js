"use strict";$(document).ready(function(){var i;window.addEventListener("message",function(e){i=JSON.parse(e.data),console.log("currentInput",i),i&&i.payIDName},!1);var e=document.querySelectorAll(".mdc-text-field"),t=!0,a=!1,s=void 0;try{for(var r,n=e[Symbol.iterator]();!(t=(r=n.next()).done);t=!0){var l=r.value;mdc.textField.MDCTextField.attachTo(l)}}catch(e){a=!0,s=e}finally{try{t||null==n.return||n.return()}finally{if(a)throw s}}var o={input:$("#cruxpayId"),inputParent:$(".cruxpay-id__container"),helperText:$("#cruxpay-id__helper-text"),parentContainer:$(".cruxpay-id__container").parent(),displayError:function(e){this.helperText.removeClass("helper-text--success"),this.inputParent.addClass("mdc-text-field--invalid"),this.parentContainer.addClass("has-error"),this.helperText.html(e)},displaySuccess:function(e){o.inputParent.removeClass("mdc-text-field--invalid"),o.helperText.addClass("helper-text--success"),o.parentContainer.removeClass("has-error"),o.helperText.html(e)},displayHelpText:function(e){o.helperText.removeClass("helper-text--success"),o.inputParent.removeClass("mdc-text-field--invalid"),o.parentContainer.removeClass("has-error"),o.helperText.html(e)},getId:function(){return this.input.val()},isValid:!1},d=null;o.input.on("keyup",function(e){o.displayHelpText("Checking availability"),o.isValid=!1,clearTimeout(d),d=setTimeout(function(){e.target.value&&0<e.target.value.length&&function(i){$.ajax({type:"GET",url:"https://167.71.234.131:3000/status/".concat(i),success:function(e){o.isValid=!1,o.displayError("".concat(i," is unavailable"))},error:function(e,t,a){404==e.status&&(o.isValid=!0,o.displaySuccess("".concat(i," is available")))}})}(e.target.value)},500)});var c={input:$("#cruxpayPassword"),helperText:$("#cruxpay-password__helper-text"),inputParent:$(".cruxpay-password__container"),parentContainer:$(".cruxpay-password__container").parent(),isValid:!1,validation:{isValid:function(e){return/^[a-zA-Z0-9$@!#^&%_-]{8,50}$/.test(String(e).toLowerCase())},containsId:function(e){return e===o.input.val()},hasDigit:function(e){return/[0-9]/.test(e)},hasLowerCase:function(e){return/[a-z]/.test(e)},hasUpperCase:function(e){return/[A-Z]/.test(e)},hasSpecialCharacter:function(e){return/(?=.*[!#$%&?@"])/.test(e)}},displayError:function(e){this.helperText.removeClass("helper-text--success"),this.inputParent.addClass("mdc-text-field--invalid"),this.parentContainer.addClass("has-error"),this.helperText.html(e)},clearAllError:function(){this.helperText.addClass("helper-text--success"),this.inputParent.removeClass("mdc-text-field--invalid"),this.parentContainer.removeClass("has-error"),this.helperText.html("")},toggleValidationBlock:function(e){e?$(".validation-rules").css("opacity",1):$(".validation-rules").css("opacity",0)},setValidation:function(e,t){var a=$("#validation-".concat(e));this.isValid=t,a&&0<a.length&&(t?(a.removeClass("rule-isInvalid"),a.addClass("rule-isValid")):(a.addClass("rule-isInvalid"),a.removeClass("rule-isValid")))},getPassword:function(){return this.input.val()},runValidations:function(e){this.validation.isValid(e)?this.setValidation("charLen",!0):(this.setValidation("charLen",!1),this.displayError("Minimum length required is 8. Only following special characters !,#,$,%,&,?,@ are allowed")),this.validation.containsId(e)?(this.setValidation("sameAsId",!1),this.displayError("Password must be different from CruxPay ID")):this.setValidation("sameAsId",!0),this.validation.hasDigit(e)?this.setValidation("digit",!0):(this.setValidation("digit",!1),this.displayError("Password must be have atleast one number")),this.validation.hasLowerCase(e)?this.setValidation("lowercase",!0):(this.setValidation("lowercase",!1),this.displayError("Password must be have atleast one lowercase letter")),this.validation.hasUpperCase(e)?this.setValidation("uppercase",!0):(this.setValidation("uppercase",!1),this.displayError("Password must be have atleast one uppercase letter")),this.validation.hasSpecialCharacter(e)?(this.setValidation("specialCharater",!0),this.clearAllError()):(this.setValidation("specialCharater",!1),this.displayError("Password must be have atleast one of following special characters !,#,$,%,&,?,@ are allowed"))}};c.input.on("keyup",function(e){if(c.toggleValidationBlock(!0),e.target.value&&0<e.target.value.length){var t=e.target.value;c.runValidations(t)}}),$("#createId").on("click",function(){if(o.isValid&&c.isValid){var e=o.getId(),t=c.getPassword(),a={type:"createNew",data:{newPayIDName:e,newPayIDPass:t}};"iframe"==i.experience?window.parent.postMessage(JSON.stringify(a),"*"):window.opener.postMessage(JSON.stringify(a),"*")}else c.isValid||c.runValidations(c.getPassword()),o.isValid||o.displayError(o.getId()&&0<o.getId().length?"".concat(o.getId()," is unavailable"):"cruxpay id is needed")})});